# Nexus æ¶æ„å¿«é€Ÿå‚è€ƒ

## æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **ä¸‰å±‚æ¶æ„**ï¼šPresentation â†’ Application â†’ Domain
2. **æœåŠ¡åˆ†ç»„**ï¼šAppState æŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œé¿å…è‡ƒè‚¿
3. **æ¨¡å—ç‹¬ç«‹**ï¼šæ¯ä¸ªä¸šåŠ¡é¢†åŸŸç‹¬ç«‹æ¨¡å—ï¼Œäº’ä¸å¹²æ‰°
4. **ç»Ÿä¸€æŠ½è±¡**ï¼šRepositoryã€Service ç­‰é€šç”¨æ¨¡å¼
5. **ä¾èµ–å€’ç½®**ï¼šDomain Layer ä¸ä¾èµ–ä¸Šå±‚

## æ¶æ„å±‚æ¬¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Presentation Layer (routes/)                     â”‚
â”‚  â€¢ HTTP è·¯ç”±å®šä¹‰                                              â”‚
â”‚  â€¢ OpenAPI æ–‡æ¡£æ³¨è§£                                           â”‚
â”‚  â€¢ è°ƒç”¨ Application Layer                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Application Layer (routes/handlers/)              â”‚
â”‚  â€¢ HTTP è¯·æ±‚å¤„ç†                                              â”‚
â”‚  â€¢ ä¸šåŠ¡é€»è¾‘ç¼–æ’                                               â”‚
â”‚  â€¢ DTO â†” Domain è½¬æ¢                                         â”‚
â”‚  â€¢ è°ƒç”¨ Domain Layer æœåŠ¡                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Domain Layer (domain/)                            â”‚
â”‚  â€¢ é¢†åŸŸæ¨¡å‹å®šä¹‰                                               â”‚
â”‚  â€¢ ä¸šåŠ¡è§„åˆ™å®ç°                                               â”‚
â”‚  â€¢ é¢†åŸŸæœåŠ¡                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Infrastructure (infrastructure/)                   â”‚
â”‚  â€¢ ç¼“å­˜å®ç°                                                   â”‚
â”‚  â€¢ é˜Ÿåˆ—å®ç°                                                   â”‚
â”‚  â€¢ æ•°æ®åº“è®¿é—®                                                 â”‚
â”‚  â€¢ å¤–éƒ¨æœåŠ¡é›†æˆ                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ç›®å½•ç»“æ„ï¼ˆé‡æ„åï¼‰

```
nexus/src/
â”œâ”€â”€ lib.rs                    # åº“å…¥å£
â”œâ”€â”€ main.rs                   # äºŒè¿›åˆ¶å…¥å£
â”œâ”€â”€ state.rs                  # åº”ç”¨çŠ¶æ€ç®¡ç†
â”‚
â”œâ”€â”€ integration/              # ğŸ”— é›†æˆå±‚ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â””â”€â”€ llm_agent.rs         # æ¡¥æ¥ llm-adapter å’Œ AgentFlow
â”‚
â”œâ”€â”€ routes/                   # Presentation Layer
â”‚   â”œâ”€â”€ mod.rs               # è·¯ç”±ç»„è£…
â”‚   â”œâ”€â”€ api_doc.rs           # OpenAPI æ–‡æ¡£ç»„åˆ
â”‚   â”œâ”€â”€ common.rs            # é€šç”¨å“åº”è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ config/              # é…ç½®ç®¡ç† API
â”‚   â”œâ”€â”€ health.rs            # å¥åº·æ£€æŸ¥
â”‚   â””â”€â”€ invoke.rs            # LLM è°ƒç”¨
â”‚
â”œâ”€â”€ routes/handlers/          # Application Layer
â”‚   â”œâ”€â”€ config/              # é…ç½®å¤„ç†é€»è¾‘
â”‚   â””â”€â”€ invoke.rs            # è°ƒç”¨å¤„ç†é€»è¾‘
â”‚
â”œâ”€â”€ domain/                   # Domain Layer
â”‚   â””â”€â”€ config/             # é…ç½®ç®¡ç†é¢†åŸŸ
â”‚
â”œâ”€â”€ application/              # Application Layer
â”‚   â”œâ”€â”€ planner.rs          # ä»»åŠ¡è§„åˆ’
â”‚   â”œâ”€â”€ postprocessor.rs    # åå¤„ç†é“¾
â”‚   â”œâ”€â”€ prompt.rs           # æç¤ºè¯
â”‚   â””â”€â”€ kb/                 # çŸ¥è¯†åº“
â”‚
â””â”€â”€ infrastructure/           # Infrastructure Layer
    â”œâ”€â”€ cache/              # ç¼“å­˜
    â”œâ”€â”€ queue/              # é˜Ÿåˆ—
    â””â”€â”€ messaging/          # æ¶ˆæ¯æ€»çº¿

æ³¨ï¼š
- LLM é€‚é…å™¨åŠŸèƒ½ â†’ ä½¿ç”¨ llm-adapter crate
- å¤šä»£ç†åŠŸèƒ½ â†’ ä½¿ç”¨ AgentFlow crate
```

## æ·»åŠ æ–°ä¸šåŠ¡æ¨¡å—ï¼ˆ3 æ­¥ï¼‰

1. **Domain Layer**ï¼š`src/domain/<domain>/` - é¢†åŸŸæ¨¡å‹å’ŒæœåŠ¡
2. **Application Layer**ï¼š`src/routes/handlers/<domain>/` - å¤„ç†é€»è¾‘
3. **Presentation Layer**ï¼š`src/routes/<domain>/` - API è·¯ç”±

## å…³é”®è®¾è®¡æ¨¡å¼

- **Repository Pattern**ï¼šæ•°æ®è®¿é—®æŠ½è±¡
- **Service Pattern**ï¼šä¸šåŠ¡é€»è¾‘å°è£…
- **DTO Pattern**ï¼šAPI æ•°æ®ä¼ è¾“
- **Factory Pattern**ï¼šå¯¹è±¡åˆ›å»º
- **Strategy Pattern**ï¼šè·¯ç”±ç­–ç•¥

è¯¦ç»†æ¶æ„è®¾è®¡è¯·å‚é˜…ï¼š[`ARCHITECTURE_DESIGN.md`](ARCHITECTURE_DESIGN.md)
